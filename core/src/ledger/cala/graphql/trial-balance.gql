query TrialBalance($accountSetId: UUID!, $journalId: UUID!) {
  accountSet(id: $accountSetId) {
    name
    ...accountSetBalances
    normalBalanceType
    accounts: members(first: 100) {
      edges {
        node {
          __typename
          ... on AccountSet {
            accountSetId
            name
            normalBalanceType
            members(first: 1) {
              pageInfo {
                startCursor
              }
            }
            ...accountSetBalances
          }
          ... on Account {
            accountId
            name
            normalBalanceType
            ...accountBalances
          }
        }
      }
    }
  }
}

fragment accountBalances on Account {
  btcBalances: balance(journalId: $journalId, currency: "BTC") {
    ...balancesByLayer
  }
  usdtBalances: balance(journalId: $journalId, currency: "USDT") {
    ...balancesByLayer
  }
  usdBalances: balance(journalId: $journalId, currency: "USD") {
    ...balancesByLayer
  }
}

fragment accountSetBalances on AccountSet {
  btcBalances: balance(currency: "BTC") {
    ...balancesByLayer
  }
  usdtBalances: balance(currency: "USDT") {
    ...balancesByLayer
  }
  usdBalances: balance(currency: "USD") {
    ...balancesByLayer
  }
}

fragment balancesByLayer on Balance {
  settled {
    ...balances
  }
  pending {
    ...balances
  }
  encumbrance {
    ...balances
  }
  allLayersAvailable: available(layer: ENCUMBRANCE) {
    ...balances
  }
}

fragment balances on BalanceAmount {
  normalBalance {
    units
    currency
  }
  drBalance {
    units
    currency
  }
  crBalance {
    units
    currency
  }
}
