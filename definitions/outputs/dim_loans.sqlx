config {
	type: "table",
	description: "Each row represents a unique approved loan.",
	assertions: {
		uniqueKey: ["loan_id"],
		nonNull: ["loan_id", "initialized_at", "end_date", "annual_rate", "customer_id", "completed", "principal"],
		rowConditions: ["DATE(initialized_at) <= end_date"],
	},
}

SELECT *

FROM ${ref("int_approved_loans")}(TIMESTAMP_TRUNC(CURRENT_TIMESTAMP(), DAY))
