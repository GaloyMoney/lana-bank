config {
	type: "table",
}

SELECT DISTINCT
	  JSON_VALUE(event, "$.id") AS customer_id
	, ROW_NUMBER() OVER () AS customer_key
	, JSON_VALUE(event, "$.email") AS email

FROM ${ref({
	name: "customer_events",
	schema: envs.currentImportSchema
})}

WHERE event_type = "initialized"
