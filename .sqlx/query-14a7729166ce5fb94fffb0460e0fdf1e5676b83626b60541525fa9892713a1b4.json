{
  "db_name": "PostgreSQL",
  "query": "\n        WITH min_wait AS (\n            SELECT MIN(execute_at) - $2::timestamptz AS wait_time\n            FROM job_executions\n            WHERE state = 'pending'\n            AND execute_at > $2::timestamptz\n            AND job_type = ANY($4)\n        ),\n        selected_jobs AS (\n            SELECT id, execution_state_json AS data_json, attempt_index\n            FROM job_executions\n            WHERE execute_at <= $2::timestamptz\n            AND state = 'pending'\n            AND job_type = ANY($4)\n            ORDER BY execute_at ASC\n            LIMIT $1\n            FOR UPDATE\n        ),\n        updated AS (\n            UPDATE job_executions AS je\n            SET state = 'running', alive_at = $2, execute_at = NULL, poller_instance_id = $3\n            FROM selected_jobs\n            WHERE je.id = selected_jobs.id\n            RETURNING je.id, selected_jobs.data_json, je.attempt_index\n        )\n        SELECT * FROM (\n            SELECT\n                u.id AS \"id?: JobId\",\n                u.data_json AS \"data_json?: JsonValue\",\n                u.attempt_index AS \"attempt_index?\",\n                NULL::INTERVAL AS \"max_wait?: PgInterval\"\n            FROM updated u\n            UNION ALL\n            SELECT\n                NULL::UUID AS \"id?: JobId\",\n                NULL::JSONB AS \"data_json?: JsonValue\",\n                NULL::INT AS \"attempt_index?\",\n                mw.wait_time AS \"max_wait?: PgInterval\"\n            FROM min_wait mw\n            WHERE NOT EXISTS (SELECT 1 FROM updated)\n        ) AS result\n        ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id?: JobId",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "data_json?: JsonValue",
        "type_info": "Jsonb"
      },
      {
        "ordinal": 2,
        "name": "attempt_index?",
        "type_info": "Int4"
      },
      {
        "ordinal": 3,
        "name": "max_wait?: PgInterval",
        "type_info": "Interval"
      }
    ],
    "parameters": {
      "Left": [
        "Int8",
        "Timestamptz",
        "Uuid",
        "TextArray"
      ]
    },
    "nullable": [
      null,
      null,
      null,
      null
    ]
  },
  "hash": "14a7729166ce5fb94fffb0460e0fdf1e5676b83626b60541525fa9892713a1b4"
}
