version: 2

models:
  - name: report_nrp_51_01_saldo_cuenta
    description: saldo_cuenta.xml per NRP-51.
    tests:
      - dbt_utils.expression_is_true:
          expression: "regexp_contains(id_codigo_cuenta, r'^[0-9]{1,10}$')"
      - dbt_utils.expression_is_true:
          expression: "char_length(nom_cuenta) between 1 and 80"
      - dbt_utils.expression_is_true:
          expression: "nom_cuenta = upper(nom_cuenta)"
      - dbt_utils.expression_is_true:
          expression: "regexp_contains(valor, r'^[0-9]{1,15}[.][0-9][0-9]$')"

    columns:
      - name: id_codigo_cuenta
        description: >
          Account code (XsString, length ≤10, no zero padding) per NRP-51 Annex 1 and Annex 2.A.
          Must come from the official chart and must not be modified.
        tests:
          - not_null
          - unique
      - name: nom_cuenta
        description: >
          Account description (XsString, length ≤80, uppercase) per NRP-51 Annex 1 and Annex 2.A.
          Provided by the supervisor; must not be modified.
        tests:
          - not_null
      - name: valor
        description: >
          Account balance (XsDecimal, totalDigits=17, fractionDigits=2). Must always be sent,
          including zero balances (NRP-51 Annex 1 and Annex 2.A).
        tests:
          - not_null
