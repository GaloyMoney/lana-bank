# This file contains settings for `cargo hakari`.
# See https://docs.rs/cargo-hakari/latest/cargo_hakari/config for a full list of options.

hakari-package = "workspace-hack"

# Format version for hakari's output. Version 4 requires cargo-hakari 0.9.22 or above.
dep-format-version = "4"

# Setting workspace.resolver = "2" or higher in the root Cargo.toml is HIGHLY recommended.
# Hakari works much better with the v2 resolver. (The v2 and v3 resolvers are identical from
# hakari's perspective, so you're welcome to set either.)
#
# For more about the new feature resolver, see:
# https://blog.rust-lang.org/2021/03/25/Rust-1.51.0.html#cargos-new-feature-resolver
resolver = "2"

# Add triples corresponding to platforms commonly used by developers here.
# https://doc.rust-lang.org/rustc/platform-support.html
platforms = [
    # "x86_64-unknown-linux-gnu",
    # "x86_64-apple-darwin",
    # "aarch64-apple-darwin",
    # "x86_64-pc-windows-msvc",
]

# Write out exact versions rather than a semver range. (Defaults to false.)
# exact-versions = true

# Only unify features for crates that naturally appear in both target and host
# dependency graphs. The default "auto" replicates nearly all target deps into
# [build-dependencies], forcing heavy crates like cala-ledger to compile twice.
unify-target-host = "unify-if-both"

# Exclude proc-macro crates from getting workspace-hack as a dependency.
# Proc-macros compile on the host platform, so adding workspace-hack pulls
# all its deps (including cala-ledger ~30s) into the host graph. Since the
# host graph has different features (e.g. axum without `ws`), this causes
# heavy crates to be compiled twice instead of once.
[traversal-excludes]
workspace-members = ["tracing-macros", "tracing-utils"]
third-party = [
    { name = "cala-ledger" },
    { name = "cala-ledger-core-types" },
    { name = "cala-cel-interpreter" },
    { name = "es-entity" },
    { name = "obix" },
    { name = "job" },
]
